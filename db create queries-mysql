CREATE TABLE item(
	id INT UNSIGNED AUTO_INCREMENT,
	title TINYTEXT NOT NULL,
	price INT UNSIGNED NOT NULL DEFAULT 0,
	loc CHAR(30) NOT NULL,
	reg_date DATETIME NOT NULL,
	exp_date DATETIME NOT NULL,
	id_code INT UNSIGNED,
	item_class TINYINT UNSIGNED NOT NULL DEFAULT 0,
	PRIMARY KEY(id),
	FOREIGN KEY(id_code) REFERENCES users(id_code)
);

CREATE TABLE content(
	id INT UNSIGNED,
	content TEXT NOT NULL,
	PRIMARY KEY(id),
	FOREIGN KEY(id) REFERENCES item(id)
);

CREATE TABLE photos(
	id INT UNSIGNED,
	filename CHAR(255) NOT NULL,
	PRIMARY KEY(id, filename),
	FOREIGN KEY(id) REFERENCES item(id)
);

CREATE TABLE users(
	id_code INT UNSIGNED AUTO_INCREMENT,
	id CHAR(255) UNIQUE,
	pw CHAR(255) NOT NULL,
	name CHAR(255) NOT NULL,
	nickname CHAR(255) NOT NULL UNIQUE,
	PRIMARY KEY(id_code)
);

CREATE TABLE login_users(
	id_code INT UNSIGNED PRIMARY KEY,
	token CHAR(255) UNIQUE NOT NULL,
	FOREIGN KEY(id_code) REFERENCES users(id_code)
);

CREATE TABLE comments(
	comment_id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
	parent_id INT UNSIGNED,
	item_id INT UNSIGNED NOT NULL,
	user_id INT UNSIGNED NOT NULL,
	content TEXT NOT NULL NOT NULL,
	reg_date DATETIME NOT NULL,
	FOREIGN KEY(parent_id) REFERENCES comments(comment_id) ON DELETE CASCADE,
	FOREIGN KEY(item_id) REFERENCES item(id) ON DELETE CASCADE,
	FOREIGN KEY(user_id) REFERENCES users(id_code) ON DELETE CASCADE
);
